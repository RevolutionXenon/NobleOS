// GLUON: x86-64 MODEL SPECIFIC REGISTER
// Structs and objects handling Model Specific Registers


// HEADER
//Imports
use crate::x86_64::instructions::rdmsr;
use crate::x86_64::instructions::wrmsr;


// MODEL SPECIFIC REGISTER
pub struct MSR(u32);
impl MSR {
    #[inline] pub fn read (&self) -> u64      {rdmsr(self.0)}
    #[inline] pub fn write(&self, value: u64) {wrmsr(self.0, value)}
}


// ARCHITECTURAL MODEL SPECIFIC REGISTERS
pub static IA32_P5_MC_ADDR:               MSR = MSR(0x0000_0000);
pub static IA32_P5_MC_TYPE:               MSR = MSR(0x0000_0001);
pub static IA32_MONITOR_FILTER_SIZE:      MSR = MSR(0x0000_0006);
pub static IA32_TIME_STAMP_COUNTER:       MSR = MSR(0x0000_0010);
pub static IA32_PLATFORM_ID:              MSR = MSR(0x0000_0017);
pub static IA32_APIC_BASE:                MSR = MSR(0x0000_001B);
pub static IA32_FEATURE_CONTROL:          MSR = MSR(0x0000_003A);
pub static IA32_TSC_ADJUST:               MSR = MSR(0x0000_003B);
pub static IA32_SPEC_CTRL:                MSR = MSR(0x0000_0048);
pub static IA32_PRED_CMD:                 MSR = MSR(0x0000_0049);
pub static IA32_BIOS_UPDT_TRIG:           MSR = MSR(0x0000_0079);
pub static IA32_BIOS_SIGN_ID:             MSR = MSR(0x0000_008B);
pub static IA32_SGXLEPUBKEYHASH0:         MSR = MSR(0x0000_008C);
pub static IA32_SGXLEPUBKEYHASH1:         MSR = MSR(0x0000_008D);
pub static IA32_SGXLEPUBKEYHASH2:         MSR = MSR(0x0000_008E);
pub static IA32_SGXLEPUBKEYHASH3:         MSR = MSR(0x0000_008F);
pub static IA32_SMM_MONITOR_CTL:          MSR = MSR(0x0000_009B);
pub static IA32_SMBASE:                   MSR = MSR(0x0000_009E);
pub static IA32_PMC0:                     MSR = MSR(0x0000_00C1);
pub static IA32_PMC1:                     MSR = MSR(0x0000_00C2);
pub static IA32_PMC2:                     MSR = MSR(0x0000_00C3);
pub static IA32_PMC3:                     MSR = MSR(0x0000_00C4);
pub static IA32_PMC4:                     MSR = MSR(0x0000_00C5);
pub static IA32_PMC5:                     MSR = MSR(0x0000_00C6);
pub static IA32_PMC6:                     MSR = MSR(0x0000_00C7);
pub static IA32_PMC7:                     MSR = MSR(0x0000_00C8);
pub static IA32_CORE_CAPABILITIES:        MSR = MSR(0x0000_00CF);
pub static IA32_UMWAIT_CONTROL:           MSR = MSR(0x0000_00E1);
pub static IA32_MPERF:                    MSR = MSR(0x0000_00E7);
pub static IA32_APERF:                    MSR = MSR(0x0000_00E8);
pub static IA32_MTRRCAP:                  MSR = MSR(0x0000_00FE);
pub static IA32_ARCH_CAPABILITIES:        MSR = MSR(0x0000_010A);
pub static IA32_FLUSH_CMD:                MSR = MSR(0x0000_010B);
pub static IA32_TSX_CTRL:                 MSR = MSR(0x0000_0122);
pub static IA32_SYSENTER_CS:              MSR = MSR(0x0000_0174);
pub static IA32_SYSENTER_ESP:             MSR = MSR(0x0000_0175);
pub static IA32_SYSENTER_EIP:             MSR = MSR(0x0000_0176);
pub static IA32_MCG_CAP:                  MSR = MSR(0x0000_0179);
pub static IA32_MCG_STATUS:               MSR = MSR(0x0000_017A);
pub static IA32_MCG_CTL:                  MSR = MSR(0x0000_017B);
pub static IA32_PERFEVTSEL0:              MSR = MSR(0x0000_0186);
pub static IA32_PERFEVTSEL1:              MSR = MSR(0x0000_0187);
pub static IA32_PERFEVTSEL2:              MSR = MSR(0x0000_0188);
pub static IA32_PERFEVTSEL3:              MSR = MSR(0x0000_0189);
pub static IA32_PERF_STATUS:              MSR = MSR(0x0000_0198);
pub static IA32_PERF_CTL:                 MSR = MSR(0x0000_0199);
pub static IA32_CLOCK_MODULATION:         MSR = MSR(0x0000_019A);
pub static IA32_THERM_INTERRUPT:          MSR = MSR(0x0000_019B);
pub static IA32_THERM_STATUS:             MSR = MSR(0x0000_019C);
pub static IA32_MISC_ENABLE:              MSR = MSR(0x0000_01A0);
pub static IA32_ENERGY_PERF_BIAS:         MSR = MSR(0x0000_01B0);
pub static IA32_PACKAGE_THERM_STATUS:     MSR = MSR(0x0000_01B1);
pub static IA32_PACKAGE_THERM_INTERRUPT:  MSR = MSR(0x0000_01B2);
pub static IA32_DEBUGCTL:                 MSR = MSR(0x0000_01D9);
pub static IA32_SMRR_PHYSBASE:            MSR = MSR(0x0000_01F2);
pub static IA32_SMRR_PHYSMASK:            MSR = MSR(0x0000_01F3);
pub static IA32_PLATFORM_DCA_CAP:         MSR = MSR(0x0000_01F8);
pub static IA32_CPU_DCA_CAP:              MSR = MSR(0x0000_01F9);
pub static IA32_DCA_0_CAP:                MSR = MSR(0x0000_01FA);
pub static IA32_MTRR_PHYSBASE0:           MSR = MSR(0x0000_0200);
pub static IA32_MTRR_PHYSMASK0:           MSR = MSR(0x0000_0201);
pub static IA32_MTRR_PHYSBASE1:           MSR = MSR(0x0000_0202);
pub static IA32_MTRR_PHYSMASK1:           MSR = MSR(0x0000_0203);
pub static IA32_MTRR_PHYSBASE2:           MSR = MSR(0x0000_0204);
pub static IA32_MTRR_PHYSMASK2:           MSR = MSR(0x0000_0205);
pub static IA32_MTRR_PHYSBASE3:           MSR = MSR(0x0000_0206);
pub static IA32_MTRR_PHYSMASK3:           MSR = MSR(0x0000_0207);
pub static IA32_MTRR_PHYSBASE4:           MSR = MSR(0x0000_0208);
pub static IA32_MTRR_PHYSMASK4:           MSR = MSR(0x0000_0209);
pub static IA32_MTRR_PHYSBASE5:           MSR = MSR(0x0000_020A);
pub static IA32_MTRR_PHYSMASK5:           MSR = MSR(0x0000_020B);
pub static IA32_MTRR_PHYSBASE6:           MSR = MSR(0x0000_020C);
pub static IA32_MTRR_PHYSMASK6:           MSR = MSR(0x0000_020D);
pub static IA32_MTRR_PHYSBASE7:           MSR = MSR(0x0000_020E);
pub static IA32_MTRR_PHYSMASK7:           MSR = MSR(0x0000_020F);
pub static IA32_MTRR_PHYSBASE8:           MSR = MSR(0x0000_0210);
pub static IA32_MTRR_PHYSMASK8:           MSR = MSR(0x0000_0211);
pub static IA32_MTRR_PHYSBASE9:           MSR = MSR(0x0000_0212);
pub static IA32_MTRR_PHYSMASK9:           MSR = MSR(0x0000_0213);
pub static IA32_MTRR_FIX64K_00000:        MSR = MSR(0x0000_0250);
pub static IA32_MTRR_FIX16K_80000:        MSR = MSR(0x0000_0258);
pub static IA32_MTRR_FIX16K_A0000:        MSR = MSR(0x0000_0259);
pub static IA32_MTRR_FIX4K_C0000:         MSR = MSR(0x0000_0268);
pub static IA32_MTRR_FIX4K_C8000:         MSR = MSR(0x0000_0269);
pub static IA32_MTRR_FIX4K_D0000:         MSR = MSR(0x0000_026A);
pub static IA32_MTRR_FIX4K_D8000:         MSR = MSR(0x0000_026B);
pub static IA32_MTRR_FIX4K_E0000:         MSR = MSR(0x0000_026C);
pub static IA32_MTRR_FIX4K_E8000:         MSR = MSR(0x0000_026D);
pub static IA32_MTRR_FIX4K_F0000:         MSR = MSR(0x0000_026E);
pub static IA32_MTRR_FIX4K_F8000:         MSR = MSR(0x0000_026F);
pub static IA32_PAT:                      MSR = MSR(0x0000_0277);
pub static IA32_MC0_CTL2:                 MSR = MSR(0x0000_0280);
pub static IA32_MC1_CTL2:                 MSR = MSR(0x0000_0281);
pub static IA32_MC2_CTL2:                 MSR = MSR(0x0000_0282);
pub static IA32_MC3_CTL2:                 MSR = MSR(0x0000_0283);
pub static IA32_MC4_CTL2:                 MSR = MSR(0x0000_0284);
pub static IA32_MC5_CTL2:                 MSR = MSR(0x0000_0285);
pub static IA32_MC6_CTL2:                 MSR = MSR(0x0000_0286);
pub static IA32_MC7_CTL2:                 MSR = MSR(0x0000_0287);
pub static IA32_MC8_CTL2:                 MSR = MSR(0x0000_0288);
pub static IA32_MC9_CTL2:                 MSR = MSR(0x0000_0289);
pub static IA32_MC10_CTL2:                MSR = MSR(0x0000_028A);
pub static IA32_MC11_CTL2:                MSR = MSR(0x0000_028B);
pub static IA32_MC12_CTL2:                MSR = MSR(0x0000_028C);
pub static IA32_MC13_CTL2:                MSR = MSR(0x0000_028D);
pub static IA32_MC14_CTL2:                MSR = MSR(0x0000_028E);
pub static IA32_MC15_CTL2:                MSR = MSR(0x0000_028F);
pub static IA32_MC16_CTL2:                MSR = MSR(0x0000_0290);
pub static IA32_MC17_CTL2:                MSR = MSR(0x0000_0291);
pub static IA32_MC18_CTL2:                MSR = MSR(0x0000_0292);
pub static IA32_MC19_CTL2:                MSR = MSR(0x0000_0293);
pub static IA32_MC20_CTL2:                MSR = MSR(0x0000_0294);
pub static IA32_MC21_CTL2:                MSR = MSR(0x0000_0295);
pub static IA32_MC22_CTL2:                MSR = MSR(0x0000_0296);
pub static IA32_MC23_CTL2:                MSR = MSR(0x0000_0297);
pub static IA32_MC24_CTL2:                MSR = MSR(0x0000_0298);
pub static IA32_MC25_CTL2:                MSR = MSR(0x0000_0299);
pub static IA32_MC26_CTL2:                MSR = MSR(0x0000_029A);
pub static IA32_MC27_CTL2:                MSR = MSR(0x0000_029B);
pub static IA32_MC28_CTL2:                MSR = MSR(0x0000_029C);
pub static IA32_MC29_CTL2:                MSR = MSR(0x0000_029D);
pub static IA32_MC30_CTL2:                MSR = MSR(0x0000_029E);
pub static IA32_MC31_CTL2:                MSR = MSR(0x0000_029F);
pub static IA32_MTRR_DEF_TYPE:            MSR = MSR(0x0000_02FF);
pub static IA32_FIXED_CTR0:               MSR = MSR(0x0000_0309);
pub static IA32_FIXED_CTR1:               MSR = MSR(0x0000_030A);
pub static IA32_FIXED_CTR2:               MSR = MSR(0x0000_030B);
pub static IA32_PERF_CAPABILITIES:        MSR = MSR(0x0000_0345);
pub static IA32_FIXED_CTR_CTRL:           MSR = MSR(0x0000_038D);
pub static IA32_PERF_GLOBAL_STATUS:       MSR = MSR(0x0000_038E);
pub static IA32_PERF_GLOBAL_CTRL:         MSR = MSR(0x0000_038F);
pub static IA32_PERF_GLOBAL_OVF_CTRL:     MSR = MSR(0x0000_0390);
pub static IA32_PERF_GLOBAL_STATUS_RESET: MSR = MSR(0x0000_0390);
pub static IA32_PERF_GLOBAL_STATUS_SET:   MSR = MSR(0x0000_0391);
pub static IA32_PERF_GLOBAL_INUSE:        MSR = MSR(0x0000_0392);
pub static IA32_PEBS_ENABLE:              MSR = MSR(0x0000_03F1);
pub static IA32_MC0_CTL:                  MSR = MSR(0x0000_0400);
pub static IA32_MC0_STATUS:               MSR = MSR(0x0000_0401);
pub static IA32_MC0_ADDR:                 MSR = MSR(0x0000_0402);
pub static IA32_MC0_MISC:                 MSR = MSR(0x0000_0403);
pub static IA32_MC1_CTL:                  MSR = MSR(0x0000_0404);
pub static IA32_MC1_STATUS:               MSR = MSR(0x0000_0405);
pub static IA32_MC1_ADDR:                 MSR = MSR(0x0000_0406);
pub static IA32_MC1_MISC:                 MSR = MSR(0x0000_0407);
pub static IA32_MC2_CTL:                  MSR = MSR(0x0000_0408);
pub static IA32_MC2_STATUS:               MSR = MSR(0x0000_0409);
pub static IA32_MC2_ADDR:                 MSR = MSR(0x0000_040A);
pub static IA32_MC2_MISC:                 MSR = MSR(0x0000_040B);
pub static IA32_MC3_CTL:                  MSR = MSR(0x0000_040C);
pub static IA32_MC3_STATUS:               MSR = MSR(0x0000_040D);
pub static IA32_MC3_ADDR:                 MSR = MSR(0x0000_040E);
pub static IA32_MC3_MISC:                 MSR = MSR(0x0000_040F);
pub static IA32_MC4_CTL:                  MSR = MSR(0x0000_0410);
pub static IA32_MC4_STATUS:               MSR = MSR(0x0000_0411);
pub static IA32_MC4_ADDR:                 MSR = MSR(0x0000_0412);
pub static IA32_MC4_MISC:                 MSR = MSR(0x0000_0413);
pub static IA32_MC5_CTL:                  MSR = MSR(0x0000_0414);
pub static IA32_MC5_STATUS:               MSR = MSR(0x0000_0415);
pub static IA32_MC5_ADDR:                 MSR = MSR(0x0000_0416);
pub static IA32_MC5_MISC:                 MSR = MSR(0x0000_0417);
pub static IA32_MC6_CTL:                  MSR = MSR(0x0000_0418);
pub static IA32_MC6_STATUS:               MSR = MSR(0x0000_0419);
pub static IA32_MC6_ADDR:                 MSR = MSR(0x0000_041A);
pub static IA32_MC6_MISC:                 MSR = MSR(0x0000_041B);
pub static IA32_MC7_CTL:                  MSR = MSR(0x0000_041C);
pub static IA32_MC7_STATUS:               MSR = MSR(0x0000_041D);
pub static IA32_MC7_ADDR:                 MSR = MSR(0x0000_041E);
pub static IA32_MC7_MISC:                 MSR = MSR(0x0000_041F);
pub static IA32_MC8_CTL:                  MSR = MSR(0x0000_0420);
pub static IA32_MC8_STATUS:               MSR = MSR(0x0000_0421);
pub static IA32_MC8_ADDR:                 MSR = MSR(0x0000_0422);
pub static IA32_MC8_MISC:                 MSR = MSR(0x0000_0423);
pub static IA32_MC9_CTL:                  MSR = MSR(0x0000_0424);
pub static IA32_MC9_STATUS:               MSR = MSR(0x0000_0425);
pub static IA32_MC9_ADDR:                 MSR = MSR(0x0000_0426);
pub static IA32_MC9_MISC:                 MSR = MSR(0x0000_0427);
pub static IA32_MC10_CTL:                 MSR = MSR(0x0000_0428);
pub static IA32_MC10_STATUS:              MSR = MSR(0x0000_0429);
pub static IA32_MC10_ADDR:                MSR = MSR(0x0000_042A);
pub static IA32_MC10_MISC:                MSR = MSR(0x0000_042B);
pub static IA32_MC11_CTL:                 MSR = MSR(0x0000_042C);
pub static IA32_MC11_STATUS:              MSR = MSR(0x0000_042D);
pub static IA32_MC11_ADDR:                MSR = MSR(0x0000_042E);
pub static IA32_MC11_MISC:                MSR = MSR(0x0000_042F);
pub static IA32_MC12_CTL:                 MSR = MSR(0x0000_0430);
pub static IA32_MC12_STATUS:              MSR = MSR(0x0000_0431);
pub static IA32_MC12_ADDR:                MSR = MSR(0x0000_0432);
pub static IA32_MC12_MISC:                MSR = MSR(0x0000_0433);
pub static IA32_MC13_CTL:                 MSR = MSR(0x0000_0434);
pub static IA32_MC13_STATUS:              MSR = MSR(0x0000_0435);
pub static IA32_MC13_ADDR:                MSR = MSR(0x0000_0436);
pub static IA32_MC13_MISC:                MSR = MSR(0x0000_0437);
pub static IA32_MC14_CTL:                 MSR = MSR(0x0000_0438);
pub static IA32_MC14_STATUS:              MSR = MSR(0x0000_0439);
pub static IA32_MC14_ADDR:                MSR = MSR(0x0000_043A);
pub static IA32_MC14_MISC:                MSR = MSR(0x0000_043B);
pub static IA32_MC15_CTL:                 MSR = MSR(0x0000_043C);
pub static IA32_MC15_STATUS:              MSR = MSR(0x0000_043D);
pub static IA32_MC15_ADDR:                MSR = MSR(0x0000_043E);
pub static IA32_MC15_MISC:                MSR = MSR(0x0000_043F);
pub static IA32_MC16_CTL:                 MSR = MSR(0x0000_0440);
pub static IA32_MC16_STATUS:              MSR = MSR(0x0000_0441);
pub static IA32_MC16_ADDR:                MSR = MSR(0x0000_0442);
pub static IA32_MC16_MISC:                MSR = MSR(0x0000_0443);
pub static IA32_MC17_CTL:                 MSR = MSR(0x0000_0444);
pub static IA32_MC17_STATUS:              MSR = MSR(0x0000_0445);
pub static IA32_MC17_ADDR:                MSR = MSR(0x0000_0446);
pub static IA32_MC17_MISC:                MSR = MSR(0x0000_0447);
pub static IA32_MC18_CTL:                 MSR = MSR(0x0000_0448);
pub static IA32_MC18_STATUS:              MSR = MSR(0x0000_0449);
pub static IA32_MC18_ADDR:                MSR = MSR(0x0000_044A);
pub static IA32_MC18_MISC:                MSR = MSR(0x0000_044B);
pub static IA32_MC19_CTL:                 MSR = MSR(0x0000_044C);
pub static IA32_MC19_STATUS:              MSR = MSR(0x0000_044D);
pub static IA32_MC19_ADDR:                MSR = MSR(0x0000_044E);
pub static IA32_MC19_MISC:                MSR = MSR(0x0000_044F);
pub static IA32_MC20_CTL:                 MSR = MSR(0x0000_0450);
pub static IA32_MC20_STATUS:              MSR = MSR(0x0000_0451);
pub static IA32_MC20_ADDR:                MSR = MSR(0x0000_0452);
pub static IA32_MC20_MISC:                MSR = MSR(0x0000_0453);
pub static IA32_MC21_CTL:                 MSR = MSR(0x0000_0454);
pub static IA32_MC21_STATUS:              MSR = MSR(0x0000_0455);
pub static IA32_MC21_ADDR:                MSR = MSR(0x0000_0456);
pub static IA32_MC21_MISC:                MSR = MSR(0x0000_0457);
pub static IA32_MC22_CTL:                 MSR = MSR(0x0000_0458);
pub static IA32_MC22_STATUS:              MSR = MSR(0x0000_0459);
pub static IA32_MC22_ADDR:                MSR = MSR(0x0000_045A);
pub static IA32_MC22_MISC:                MSR = MSR(0x0000_045B);
pub static IA32_MC23_CTL:                 MSR = MSR(0x0000_045C);
pub static IA32_MC23_STATUS:              MSR = MSR(0x0000_045D);
pub static IA32_MC23_ADDR:                MSR = MSR(0x0000_045E);
pub static IA32_MC23_MISC:                MSR = MSR(0x0000_045F);
pub static IA32_MC24_CTL:                 MSR = MSR(0x0000_0460);
pub static IA32_MC24_STATUS:              MSR = MSR(0x0000_0461);
pub static IA32_MC24_ADDR:                MSR = MSR(0x0000_0462);
pub static IA32_MC24_MISC:                MSR = MSR(0x0000_0463);
pub static IA32_MC25_CTL:                 MSR = MSR(0x0000_0464);
pub static IA32_MC25_STATUS:              MSR = MSR(0x0000_0465);
pub static IA32_MC25_ADDR:                MSR = MSR(0x0000_0466);
pub static IA32_MC25_MISC:                MSR = MSR(0x0000_0467);
pub static IA32_MC26_CTL:                 MSR = MSR(0x0000_0468);
pub static IA32_MC26_STATUS:              MSR = MSR(0x0000_0469);
pub static IA32_MC26_ADDR:                MSR = MSR(0x0000_046A);
pub static IA32_MC26_MISC:                MSR = MSR(0x0000_046B);
pub static IA32_MC27_CTL:                 MSR = MSR(0x0000_046C);
pub static IA32_MC27_STATUS:              MSR = MSR(0x0000_046D);
pub static IA32_MC27_ADDR:                MSR = MSR(0x0000_046E);
pub static IA32_MC27_MISC:                MSR = MSR(0x0000_046F);
pub static IA32_MC28_CTL:                 MSR = MSR(0x0000_0470);
pub static IA32_MC28_STATUS:              MSR = MSR(0x0000_0471);
pub static IA32_MC28_ADDR:                MSR = MSR(0x0000_0472);
pub static IA32_MC28_MISC:                MSR = MSR(0x0000_0473);
pub static IA32_VMX_BASIC:                MSR = MSR(0x0000_0480);
pub static IA32_VMX_PINBASED_CTLS:        MSR = MSR(0x0000_0481);
pub static IA32_VMX_PROCBASED_CTLS:       MSR = MSR(0x0000_0482);
pub static IA32_VMX_EXIT_CTLS:            MSR = MSR(0x0000_0483);
pub static IA32_VMX_ENTRY_CTLS:           MSR = MSR(0x0000_0484);
pub static IA32_VMX_MISC:                 MSR = MSR(0x0000_0485);
//Cutoff at Page 2-33, may finish at a later time
pub static IA32_EFER:                     MSR = MSR(0xC000_0080);
pub static IA32_STAR:                     MSR = MSR(0xC000_0081);
pub static IA32_LSTAR:                    MSR = MSR(0xC000_0082);
pub static IA32_CSTAR:                    MSR = MSR(0xC000_0083);
pub static IA32_FMASK:                    MSR = MSR(0xC000_0084);
pub static IA32_FS_BASE:                  MSR = MSR(0xC000_0100);
pub static IA32_GS_BASE:                  MSR = MSR(0xC000_0101);
pub static IA32_KERNEL_GS_BASE:           MSR = MSR(0xC000_0102);
pub static IA32_TSC_AUX:                  MSR = MSR(0xC000_0103);
